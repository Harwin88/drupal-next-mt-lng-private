# Values in this file override the default values of our helm chart.
#
# See https://github.com/wunderio/charts/blob/master/frontend/values.yaml
# for all possible options.
#
#
projectName: next4drupal

services:
  node:
    exposedRoute: '/'
    port: 3000
    env:
      DRUPAL_CLIENT_ID: <|DRUPAL_CLIENT_ID|>
      DRUPAL_CLIENT_SECRET: ${DRUPAL_CLIENT_SECRET}
      DRUPAL_REVALIDATE_SECRET: ${DRUPAL_REVALIDATE_SECRET}
      NEXTAUTH_SECRET: ${NEXTAUTH_SECRET}
      NEXT_PUBLIC_DRUPAL_BASE_URL: https://<|DRUPAL_DOMAIN|>
      NEXT_PUBLIC_FRONTEND_URL: https://<|NEXT_DOMAIN|>
      NEXT_IMAGE_DOMAIN: <|DRUPAL_DOMAIN|>
      NEXTAUTH_URL: https://<|NEXT_DOMAIN|>

nginx:
  extra_conditions: |
    # Pass through sitemap.xml requests to Drupal.
    location = /sitemap.xml {
      proxy_pass https://<|DRUPAL_DOMAIN|>/sites/default/files/sitemap.xml;
      proxy_http_version 1.1;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-NginX-Proxy true;
      proxy_ssl_session_reuse off;
      proxy_redirect off;
      proxy_pass_request_headers on;
      proxy_pass_request_body on;
      add_header Cache-Control "max-age=0";
      access_log off;
    }
  content_security_policy: >- # Lines below are joined without line breaks.
    upgrade-insecure-requests;
    default-src 'none';
    script-src 'self' youtube.com https://www.youtube.com;
    frame-src youtube.com https://www.youtube.com;
    style-src 'self' 'unsafe-inline';
    img-src 'self' *.wdr.io https://i.ytimg.com;
    font-src 'self' *.wdr.io;
    frame-ancestors 'self' *.wdr.io;
    base-uri 'self';
    connect-src 'self';
    form-action 'self';
